var ze=Object.defineProperty;var Pe=(y,n,S)=>n in y?ze(y,n,{enumerable:!0,configurable:!0,writable:!0,value:S}):y[n]=S;var ce=(y,n,S)=>(Pe(y,typeof n!="symbol"?n+"":n,S),S);(function(y,n){typeof exports=="object"&&typeof module!="undefined"?n(exports,require("vue")):typeof define=="function"&&define.amd?define(["exports","vue"],n):(y=typeof globalThis!="undefined"?globalThis:y||self,n(y.index={},y.Vue))})(this,function(y,n){"use strict";function S(e,l,t){let s=e;return l&&(s+=`__${l}`),t&&(s+=`--${t}`),s}function C(e,l=!1){const t=l?`.b-${e}`:`b-${e}`;return{b:()=>S(t),e:f=>f?S(t,f):"",m:f=>f?S(t,"",f):"",em:(f,m)=>f&&m?S(t,f,m):""}}const Q=[];let U=[];const W=n.ref(24),D=C("menu"),de=C("submenu"),R=D.b(),X=`${D.b()}-item-horizontal-wrapper`,Y=`${D.b()}-item-select`,Z=`${D.b()}-active-parent`;function ue(e){W.value=e}function fe(e){Q.push(e)}function me(){U=[],Q.forEach(t=>{U.push(t.el.parentElement)});const e=[...U],l=t=>{var s;return(s=/layer_(\d*)/gim.exec(t))==null?void 0:s[1]};for(;e.length;){const t=e.shift();if(t==null?void 0:t.classList.contains(R)){const s=t.children;e.unshift(...Array.from(s));continue}else{if(t.tagName==="DIV")if(t.classList.contains(`${D.b()}-item-vertical-wrapper`)||t.classList.contains(`${de.b()}-menu-item-vertical-wrapper`)){const s=t.parentElement;if(e.unshift(...Array.from(t.children)),s==null?void 0:s.classList.contains(R))t.classList.add("layer_1");else{let a=l((s==null?void 0:s.classList.value)||"");a=Number(a),t.classList.add(`layer_${a}`)}}else{const s=t.parentElement;let a=l((s==null?void 0:s.classList.value)||"");a=Number(a),t.classList.add(`layer_${a}`),t.style.paddingLeft=`${(a===2?1:a-1)*W.value}px`}if(t.tagName==="UL"){const s=t.parentElement,a=t.children;for(let f=0;f<a.length;f++)e.unshift(a[f]);const o=(s==null?void 0:s.classList.value)||"";let c=l(o);(s==null?void 0:s.classList.contains(R))?(c=1,t.classList.add(`layer_${2}`)):(t.classList.add(`layer_${Number(c)+1}`),c=Number(c)+1)}if(t.tagName==="LI"){const s=t.parentElement,a=(s==null?void 0:s.classList.value)||"";let o=l(a);l(a),o=Number(o),t.style.padding=`0 ${o*W.value}px`}}}}function pe(e){var s;const l=e;let t=null;for(let a=0;a<l.length;a++){const o=l[a];((s=o==null?void 0:o.classList)==null?void 0:s.contains(`${D.b()}-horizontal`))&&(t=o)}return t}function he(e,l){let t=l.target,s=[];const a=pe(l.composedPath());for(s=[...Array.from(a.children)],t.tagName==="SPAN"&&(t=t.parentElement);s.length;){const o=s.shift();if((o==null?void 0:o.tagName)==="UL"||(o==null?void 0:o.classList.contains(X))){const c=o==null?void 0:o.children;s.unshift(...Array.from(c))}o!==t&&(o==null||o.classList.remove(Y),o==null||o.classList.remove(Z))}}function ge(e,l){const t=[],s=l.path||l.composedPath&&l.composedPath();for(let a=0;a<s.length;a++){const o=s[a];if(!o.classList.contains(R))t.push(...Array.from(o.children));else{t.push(...Array.from(o.children));break}}for(;t.length;){const a=t.shift();((a==null?void 0:a.tagName)==="UL"||(a==null?void 0:a.classList.contains(X)))&&t.push(...Array.from(a==null?void 0:a.children)),a!==e&&((a==null?void 0:a.tagName)==="DIV"&&t.unshift(...Array.from(a==null?void 0:a.children)),a==null||a.classList.remove(Y),a==null||a.classList.remove(Z))}}function ee(e,l,t=!1){t?he(e,l):ge(e,l)}function ye(e){var s;const l=/layer_(\d{1,})/gim,t=e.className;return(s=l.exec(t))==null?void 0:s[1]}const be={disabled:{type:Boolean,default:!1},href:{type:String,default:""},route:{type:[String,Object]}},te=C("menu");function ne(e,l,t,s){const a=n.ref(!1);return t?e.includes(l)?a.value=!0:a.value=!1:e[0]===l&&!s.value?a.value=!0:a.value=!1,a.value}function ve(e){var t,s;let l=e.parentElement;for(;!l.classList.contains(te.b());)((t=l.firstElementChild)==null?void 0:t.tagName)==="DIV"&&((s=l==null?void 0:l.firstElementChild)==null||s.classList.add(`${te.b()}-active-parent`)),l=l.parentElement;return l}function Le(e,l,t,s){if(t&&l){const a=e.route||s,o=l.push(a).then(c=>c);return{route:a,routerResult:o}}}const q=C("menu");function se(e){const l=e.composedPath();for(let t=0;t<l.length;t++){const s=l[t];if(s.classList.contains(`${q.b()}-horizontal`))break;if(s.classList.contains(`${q.b()}-item-horizontal-wrapper`))continue;s.tagName!=="SPAN"&&s.classList.add(`${q.b()}-item-select`)}}const A=C("menu"),_=`${A.b()}-item-select`,we=`${A.b()}-item-disabled`;var F=n.defineComponent({name:"DMenuItem",props:be,setup(e,l){var u,p;const t=n.getCurrentInstance(),s=String(t==null?void 0:t.vnode.key),a=n.inject("menuStore"),o=n.inject("mode"),c=n.inject("multiple"),f=n.inject("defaultIndent"),m=n.inject("isCollapsed"),v=n.inject("defaultSelectKey"),{disabled:M}=n.toRefs(e),$=n.ref(ne(v.value,s,c,M)),L=n.ref(!0),x=n.inject("rootMenuEmit"),P=n.inject("useRouter"),V=t==null?void 0:t.appContext.config.globalProperties.$router,h=n.computed(()=>({[`${A.b()}-item`]:!0,[`${A.b()}-item-isCollapsed`]:m.value,[_]:$.value,[we]:M.value}));a.on("menuItem:clear:select",()=>{$.value=!1});const w=r=>{var g;r.stopPropagation();const i=r.currentTarget;let d;if(e.disabled&&r.preventDefault(),!e.disabled){if(!c)a.emit("menuItem:clear:select"),ee(i,r,o.value==="horizontal"),o.value==="horizontal"&&se(r),$.value=!0,d=Le(e,V,P,s);else if(i.classList.contains(_)){x("deselect",{type:"deselect",key:s,el:i,e:r}),$.value=!1;return}else $.value=!0,i.classList.add(_);d===void 0?x("select",{type:"select",key:s,el:i,e:r}):x("select",{type:"select",key:s,el:i,e:r,route:d})}if(o.value==="vertical"){const T=r.currentTarget;ve(T)}if(o.value==="horizontal"){const T=(g=i.parentElement)==null?void 0:g.parentElement;T==null||T.classList.add(`${A.b()}-active-parent`)}},N=n.createVNode("span",{class:`${A.b()}-icon`},[(p=(u=l.slots).icon)==null?void 0:p.call(u)]),b=n.ref(null);return n.watch(M,()=>{c||(h.value[_]=!1)}),n.watch(()=>[...v.value],r=>{$.value=ne(r,s,c,M),h.value[_]=$.value}),n.onMounted(()=>{var d,g;let r="";const i=b.value;o.value==="vertical"&&(((g=(d=i.parentElement)==null?void 0:d.parentElement)==null?void 0:g.classList.contains(A.b()))?(L.value=!0,L.value&&(i.style.paddingRight="",i.style.paddingLeft=`${f}px`),n.watch(m,T=>{T?(i.style.padding!=="0"&&(r=i.style.padding),setTimeout(()=>{i.style.padding="0",i.style.width="",i.style.textAlign="center"},300),i.style.display="block"):(i.style.padding=`${r}`,i.style.textAlign="",i.style.display="flex")})):L.value=!1)}),()=>o.value==="vertical"?n.createVNode("div",{class:`${A.b()}-item-vertical-wrapper`},[n.createVNode("li",{class:h.value,onClick:w,ref:b},[l.slots.icon!==void 0&&N,e.href===""?n.createVNode(n.Transition,{name:"fade"},{default:()=>{var r,i;return[n.withDirectives(n.createVNode("span",null,[(i=(r=l.slots).default)==null?void 0:i.call(r)]),[[n.vShow,!m.value]])]}}):n.createVNode("a",{href:e.href},[n.createVNode(n.Transition,{name:"fade"},{default:()=>{var r,i;return[(i=(r=l.slots).default)==null?void 0:i.call(r)]}})])])]):n.createVNode("li",{class:h.value,onClick:w,ref:b},[l.slots.icon!==void 0&&N,e.href===""?n.createVNode(n.Transition,{name:"fade"},{default:()=>{var r,i;return[n.withDirectives(n.createVNode("span",null,[(i=(r=l.slots).default)==null?void 0:i.call(r)]),[[n.vShow,!m.value]])]}}):n.createVNode("a",{href:e.href},[n.createVNode(n.Transition,{name:"fade"},{default:()=>{var r,i;return[(i=(r=l.slots).default)==null?void 0:i.call(r)]}})])])}});function ae(e=8){const l="abcdefghijklmnopqrstuvwxyz0123456789";let t="";for(let s=0;s<e;s++)t+=l[parseInt((Math.random()*l.length).toString())];return t}function le(e){for(;e&&e.tagName!=="LI"&&e.tagName!=="UL";)e=e.parentElement;return e}const oe="0.3s height ease-in-out, 0.3s padding-top ease-in-out, 0.3s padding-bottom ease-in-out",j={"before-enter"(e){e.style.transition=oe,e.setAttribute("data-oldPadding",e.style.padding),e.setAttribute("data-oldMargin",e.style.margin),e.style.height="0",e.style.padding="0",e.style.margin="0"},enter(e){e.dataset.oldOverflow=e.style.overflow,e.scrollHeight!==0?e.style.height=e.scrollHeight+"px":e.style.height="",e.style.padding=e.getAttribute("data-oldPadding"),e.style.margin=e.getAttribute("data-oldMargin"),e.style.overflow="hidden"},"after-enter"(e){e.style.transition="",e.style.transition="",e.style.height="",e.style.overflow=e.getAttribute("data-overflow")},"before-leave"(e){e.dataset||(e.dataset={}),e.dataset.oldPaddingTop=e.style.paddingTop,e.dataset.oldPaddingBottom=e.style.paddingBottom,e.dataset.oldOverflow=e.style.overflow,e.style.height=e.scrollHeight+"px",e.style.overflow="hidden"},leave(e){e.scrollHeight!==0&&(e.style.transition=oe,e.style.height="0",e.style.paddingTop="0",e.style.paddingBottom="0")},"after-leave"(e){e.style.transition="",e.style.height="",e.style.overflow=e.dataset.oldOverflow,e.style.paddingTop=e.dataset.oldPaddingTop,e.style.paddingBottom=e.dataset.oldPaddingBottom}};var Ne=n.defineComponent({name:"DMenuTransition",setup(e,l){return()=>n.createVNode(n.Transition,{onBeforeEnter:t=>j["before-enter"](t),onBeforeLeave:t=>j["before-leave"](t),onEnter:t=>j.enter(t),onAfterEnter:t=>j["after-enter"](t),onLeave:t=>j.leave(t),onAfterLeave:t=>j["after-leave"](t)},{default:()=>{var t,s;return[(s=(t=l.slots).default)==null?void 0:s.call(t)]}})}});const $e={title:{type:String,default:""},disabled:{type:Boolean,default:!1}},O=C("menu"),Se=C("submenu"),I=`${O.b()}-item-horizontal-wrapper-hidden`,H=`${O.b()}-item-horizontal-wrapper-show`;function k(e,l,t){const s=l.currentTarget,a=s.parentElement,o=t.children;if(t.style.padding="0 20px !important",e==="mouseenter"){if((a==null?void 0:a.tagName)==="DIV"){t.classList.add(`${O.b()}-item-horizontal-wrapper-level`);const{width:c}=s.getClientRects()[0];t.style.top="0px",t.style.left=`${c}px`}else t.style.top="26px",t.style.left="0px";t.classList.remove(I),t.classList.add(H);for(let c=0;c<o.length;c++){const f=o[c];if(f.tagName==="UL"&&f.classList.contains(Se.b())){const m=f.getElementsByClassName(`${O.b()}-item-horizontal-wrapper`)[0];f.addEventListener("mouseenter",v=>{v.stopPropagation(),k("mouseenter",v,m),m.classList.remove(I),m.classList.add(H)}),f.addEventListener("mouseleave",v=>{v.stopPropagation(),k("mouseleave",v,m),m.classList.remove(H),m.classList.add(I)})}}}e==="mouseleave"&&(t.classList.remove(H),t.classList.add(I))}const G=C("menu"),z=C("submenu").b();var K=n.defineComponent({name:"DSubMenu",props:$e,setup(e,l){const t=n.ref(!0),{vnode:{key:s}}=n.getCurrentInstance();let a=String(s);const o=n.inject("openKeys"),c=n.ref(o.value.includes(a)),f=n.inject("defaultIndent"),m=n.inject("isCollapsed"),v=n.inject("mode"),M=n.ref(null),$=n.inject("rootMenuEmit"),L=v.value==="horizontal";a==="null"&&(console.warn("[devui][menu]: Key can not be null"),a=`randomKey-${ae(16)}`);const x=u=>{u.stopPropagation();const p=le(u.target);if(!(p.classList.contains(z)&&L)&&(L&&(ee(p,u,!0),se(u)),!e.disabled&&v.value!=="horizontal")){const r=le(u.target),i=o.value.indexOf(a);i>=0&&r.tagName==="UL"?o.value.splice(i,1):r.tagName==="UL"&&o.value.push(a),c.value=o.value.indexOf(a)>=0,$("submenu-change",{type:"submenu-change",state:c.value,key:a,el:p})}},P=n.ref(null);let V;const h=n.ref(null),w=n.ref(null);let N="";const b=n.ref("");return n.watchEffect(()=>{V=P.value,fe({el:h.value})},{flush:"post"}),n.watch(()=>o,u=>{u.value.includes(a)?c.value=!0:c.value=!1},{deep:!0}),n.onMounted(()=>{var r;const u=w.value,p=h.value;me(),b.value=`layer_${(r=Array.from(p.classList).at(-1))==null?void 0:r.replace("layer_","")}`,L&&!e.disabled&&(h.value.addEventListener("mouseenter",i=>{i.stopPropagation(),k("mouseenter",i,V)}),h.value.addEventListener("mouseleave",i=>{i.stopPropagation(),k("mouseleave",i,V)})),n.watch(m,i=>{const d=Number(ye(p));Number.isNaN(d)||d>2&&(t.value=!m.value),i?(u.style.padding!=="0"&&(N=u.style.padding),setTimeout(()=>{u.style.padding="0",u.style.width="",u.style.textAlign="center"},300),u.style.display="block"):(u.style.padding=`${N}`,u.style.textAlign="",u.style.display="flex")})}),()=>{var u,p,r,i;return n.withDirectives(n.createVNode("ul",{onClick:x,class:[z,b.value,e.disabled&&`${z}-disabled`],ref:h},[n.createVNode("div",{class:[`${z}-title`],style:`padding: 0 ${f}px`,ref:w},[n.createVNode("span",{class:`${G.b()}-icon`},[(p=(u=l.slots)==null?void 0:u.icon)==null?void 0:p.call(u)]),n.withDirectives(n.createVNode("span",{class:`${z}-title-content`},[e.title]),[[n.vShow,!m.value]]),n.withDirectives(n.createVNode("i",{class:{"icon icon-chevron-up":b.value!==`layer_${z}`,"icon icon-chevron-right":b.value===`layer_${z}`,"is-opened":c.value}},null),[[n.vShow,!m.value&&s!=="overflowContainer"]])]),L?n.withDirectives(n.createVNode("div",{class:`${G.b()}-item-horizontal-wrapper ${G.b()}-item-horizontal-wrapper-hidden`,ref:P},[(i=(r=l.slots).default)==null?void 0:i.call(r)]),[[n.vShow,!e.disabled]]):n.createVNode(Ne,null,{default:()=>{var d,g;return[n.withDirectives(n.createVNode("div",{class:[`${z}-menu-item-vertical-wrapper`],ref:M},[(g=(d=l.slots).default)==null?void 0:g.call(d)]),[[n.vShow,c.value]])]}})]),[[n.vShow,t.value]])}}});const Ce={width:{type:String,default:""},collapsed:{type:Boolean,default:!1},collapsedIndent:{type:Number,default:24},indentSize:{type:Number,default:24},multiple:{type:Boolean,default:!1},openKeys:{type:Array,default:[]},defaultSelectKeys:{type:Array,default:[]},mode:{type:String,default:"vertical"},router:{type:Boolean,default:!1}};var Te="";const E={};class Ee{constructor(l){ce(this,"rootMenuName");this.rootMenuName=l}on(l,t){var s;((s=E==null?void 0:E[this.rootMenuName])==null?void 0:s[l])||Reflect.set(E[this.rootMenuName],l,[]),E[this.rootMenuName][l].push(t)}emit(l,...t){E[this.rootMenuName][l].forEach(s=>s(...t))}off(l,t){const s=E[this.rootMenuName][l].indexOf(t);s>=0&&E[this.rootMenuName][l].splice(s,1)}}function Me(e){return E[e]||Reflect.set(E,e,{}),new Ee(e)}var J=n.defineComponent({name:"DMenu",props:Ce,emits:["select","deselect","submenu-change"],setup(e,l){const t=C("menu"),{openKeys:s,mode:a,collapsed:o,defaultSelectKeys:c}=n.toRefs(e),f=ae(16),m=Me(f);n.provide("menuStore",m),n.provide("isCollapsed",o),n.provide("defaultIndent",e.indentSize),n.provide("multiple",e.multiple),n.provide("openKeys",s),n.provide("defaultSelectKey",c),n.provide("mode",a),n.provide("collapsedIndent",e.collapsedIndent),n.provide("rootMenuEmit",l.emit),n.provide("useRouter",e.router),ue(e.indentSize);const v=n.ref(null),M=n.ref(0),$=n.ref(null),L=`${t.b()}-item-select`,x=n.computed(()=>({[`${t.b()}`]:!0,[`${t.b()}-vertical`]:a.value==="vertical",[`${t.b()}-horizontal`]:a.value==="horizontal",[`${t.b()}-collapsed`]:o.value})),P=n.reactive({[L]:!1,[`${t.b()}-overflow-container`]:!0}),V=h=>{const w=Array.from(h.children);for(const N of w)if(N.classList.contains(L)){P[L]=!0;break}else P[L]=!1};return n.onMounted(()=>{var h;if(e.mode==="horizontal"){let w=!1;const N=(h=$.value)==null?void 0:h.$el,b=v.value,u=b.children,p=N.children[1],r=new IntersectionObserver(i=>{i.forEach(d=>{if(d.isIntersecting){if(!d.target.classList.contains(`${t.b()}-overflow-container`)&&d.target.style.visibility==="hidden"){r.unobserve(d.target),b.insertBefore(d.target,N),d.target.style.visibility="";const g=N.previousElementSibling;if(g&&d.boundingClientRect.width%d.target.getBoundingClientRect().width===0&&r.observe(g),g==null?void 0:g.classList.contains("devui-submenu")){const ie=g,re=g.children[1];ie.addEventListener("mouseenter",B=>{B.stopPropagation(),k("mouseenter",B,re)}),ie.addEventListener("mouseleave",B=>{B.stopPropagation(),k("mouseleave",B,re)})}M.value-=1,r.observe(d.target),p.lastChild&&p.removeChild(p.lastChild),V(p)}}else{const g=d.target.cloneNode(!0);d.target.classList.contains(`${t.b()}-overflow-container`)?w&&d.target.previousElementSibling&&p.children.length?b.appendChild(d.target.previousElementSibling):w=!0:(M.value+=1,d.target.style.visibility="hidden",N.nextSibling?b.insertBefore(d.target,N.nextSibling):b.appendChild(d.target),p.appendChild(g),V(p))}})},{root:b,threshold:1,rootMargin:"8px"});for(let i=0;i<u.length;i++)r.observe(u[i])}}),()=>{var h,w;return n.createVNode("ul",{ref:v,class:x.value,style:[e.collapsed?`width:${e.collapsedIndent*2}px`:`width: ${e.width}`]},[(w=(h=l.slots).default)==null?void 0:w.call(h),n.withDirectives(n.createVNode(K,{ref:$,key:"overflowContainer",title:"...",class:P},null),[[n.vShow,M.value>0&&a.value==="horizontal"]])])}}}),Ae={title:"Menu \u83DC\u5355",category:"\u5BFC\u822A",status:"100%",install(e){e.component(J.name,J),e.component(F.name,F),e.component(K.name,K)}};y.Menu=J,y.MenuItem=F,y.SubMenu=K,y.default=Ae,Object.defineProperty(y,"__esModule",{value:!0}),y[Symbol.toStringTag]="Module"});
